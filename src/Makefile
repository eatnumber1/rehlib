.PHONY: src/all src/clean src/depclean src/test

src/all: $(REHLIB)

src/clean:
	$(RM) $(SRC_OBJECTS) $(REFMEM_OBJECTS) $(REHLIB) $(REFMEM_LIB)

src/depclean:
	$(RM) $(SRC_DEPS) $(REFMEM_DEPS)

src/test: $(REFMEM_LIB)

-include $(SRC_DEPS) $(REFMEM_DEPS)

$(SRC_OBJECTS): CPPFLAGS := $(CPPFLAGS) $(GLIB_CPPFLAGS)

$(REHLIB): $(SRC_OBJECTS)
$(REHLIB): OBJECTS := $(SRC_OBJECTS)
$(REHLIB): LIBRARIES := $(LIBRARIES) $(GLIB_LIBRARIES) $(GMODULE_LIBRARIES)

$(REFMEM_OBJECTS): CPPFLAGS := $(CPPFLAGS) $(GLIB_CPPFLAGS) -I$(SRCDIR)

$(REFMEM_LIB): $(REFMEM_OBJECTS)
$(REFMEM_LIB): OBJECTS := $(REFMEM_OBJECTS)
$(REFMEM_LIB): LIBRARIES := $(LIBRARIES) $(GLIB_LIBRARIES) $(GMODULE_LIBRARIES)
$(REFMEM_LIB): LDFLAGS := -Wl,-undefined,dynamic_lookup
